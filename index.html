<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>OPT â€” Time Shards</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body class="bg-black text-white font-[Inter] flex flex-col items-center min-h-screen p-8">

  <h1 class="text-3xl font-bold mb-6 text-cyan-300">ONE PIECE OF TIME â€” Time Shards</h1>
  <div id="grid" class="grid gap-6 grid-cols-1 sm:grid-cols-2 md:grid-cols-3"></div>

  <script>
    // ðŸ”§ Configura tu conexiÃ³n
    const SUPABASE_URL = "https://vvhejqhiceuillazlwlp.supabase.co";       // ejemplo: https://abcd.supabase.co
    const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ2aGVqcWhpY2V1aWxsYXpsd2xwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE0OTAzOTMsImV4cCI6MjA3NzA2NjM5M30.deBKXONBB8goQVY61Fy75pTi-iNWjlKIXkbeJBW0aj8";              // copia de tu Supabase
    const db = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    // ðŸª„ FunciÃ³n para crear el fragmento visual
    const shardHTML = (s) => `
      <div class="shard relative border border-cyan-400/20 rounded-xl p-4 bg-gradient-to-b from-zinc-900 to-black hover:scale-[1.03] transition-all">
        <div class="absolute inset-0 opacity-20 bg-[radial-gradient(circle_at_center,rgba(0,255,255,0.3),transparent_70%)]"></div>
        <h2 class="text-xl font-semibold text-cyan-300 mb-2">${s.label}</h2>
        <p class="text-sm text-gray-400">${s.dt}</p>
        <p class="mt-2 text-sm">Rango: <b>${s.rank}</b></p>
        <p class="text-sm">EnergÃ­a: ${s.energy}</p>
        <p class="text-xs text-gray-400 mt-2 break-all">${s.code}</p>
        <button onclick="claim('${s.dt}')" class="mt-4 px-3 py-1 bg-cyan-500 hover:bg-cyan-400 text-black font-semibold rounded-md text-sm">Reclamar</button>
      </div>
    `;

    // âš¡ Mostrar fragmentos
    async function loadShards() {
      const { data, error } = await db.from('shards').select('*').order('dt');
      if (error) return alert(error.message);
      document.getElementById('grid').innerHTML = data.map(shardHTML).join('');
    }

    // ðŸ’Ž Reclamar (MVP sin auth)
    async function claim(dt) {
      const nombre = prompt("Tu nombre para reclamar este fragmento:");
      if (!nombre) return;
      const { error } = await db.from('shards').update({
        owner_name: nombre,
        purchased_at: new Date().toISOString()
      }).eq('dt', dt).is('owner_name', null);
      if (error) alert(error.message);
      else alert("âœ… Fragmento reclamado exitosamente.");
      loadShards();
    }

    loadShards();
  </script>

</body>
</html>
